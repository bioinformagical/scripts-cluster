#!/bin/bash

# Request a run time of 5 hours and 30 minutes
#PBS -l walltime=196:30:00

# Request 1 processor in 1 node
#PBS -l nodes=1:ppn=1

# Request 7600 megabytes memory per processor.  ( 48 usable CPUs)
##PBS -l pmem=7600mb
#PBS -l vmem=24gb
#PBS -N cccutsLikeaBetterKnife
##PBS -q bigiron
#export TMPDIR=$HOME/tmp

#Number of times to run this script
#PBS -t 1-6

#variety=Fla4BxW85
#variety=broccoxBNC
#variety=DraperJewel

cd /lustre/home/rreid2/syn/project2/

file=$(sed -n -e "${PBS_ARRAYID}p" /lustre/home/rreid2/syn/project2/file.txt )

echo   ${file};


 ~/sw/cutadapt/cutadapt-1.2.1/bin/cutadapt -q 30 --quality-base=64 ${file}.fastq  > /lustre/home/rreid2/syn/project2/${file}.cutadapt.fastq

cd /lustre/home/rreid2/syn/project2/


module load fastx-toolkit/0.0.13.2

## convert fastq to fasta
perl /lustre/home/rreid2/scripts/perl/fastq_all.pl fq2fa ${file}.cutadapt.fastq > ${file}.fna
 fastx_clipper -l 40 \
 -a GGGGGGGG \
 -a AAAAAAA \
 -a TTTTTTT \
 -a ACACTCTTTCCCTACACGACGCTCTTCCGATCT \
 -a AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT \
 -a CAAGCAGAAGACGGCATACGAGCTCTTCCGATCT \
 -a GATCGGAAGAGCACACGTCT \
 -a ACACTCTTTCCCTACACGACGCTCTTCCGATCT \
 -a AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT \
 -a GTGACTGGAGTTCAGACGTGTGCTCTTCCGATCT \
 -a ACACTCTTTCCCTACACGACGCTCTTCCGATCT \
 -a GATCGGAAGAGCACACGTCTGAACTCCAGTCAC \
 -i ${file}.fna > ${file}-clip.fasta

#fastx_clipper -a GGAGTCAAG -a AATAACCAAT -a GCGTGCCAGAT -a AATAACCAAT -a GCGTGCCAGA -i tmp.fna > tmp-clip.fasta


#~/sw/cutadapt-1.0/cutadapt -b GGAGTCAAGTGCAGAACCGAAATCATTGCCCCCTGGGTGACTAAAGAAAT \
# -b GGAGTCAAGTGCAGTAGCATTCAAGTAATGCCCTTTGATTTCACCGAGAT \
# -b GGAGTCAAGTGCAGACGATTTGACCGACCCTGCTCCTGCTACGACATTTG \
# -b GGAGTCAAGTGCAGGCCCGACTCGACAAGACAACGATCTAGAGTTAGATC \
# -b GGAGTCAAGTGCAGACTAAAGGTTTCACTTTTCATATTCTCGAAAGACAT \
# -b GGAGTCAAGTGCAGCAAACAAGGATGGTTTCGGTCCCACATTTCGTTAAT \
# -b GGAGTCAAGTGCAGCTTCACCGTCTGAGTAGCTTTCTGGCTTTTCTTACT \
# -b GGAGTCAAGTGCAGCTACAAACAACTCCTTACTAGCTACCAACTCCTTAA \
# -b GGAGTCAAGTGCAGAGACCTTAAGGATACAGGGGACAAATCTGTCTGTAC \
# -b GGAGTCAAGTGCAGAGGAAATTAAATGAAGTACTCCAGATACAAAGTATG \
# -b GGAGTCAAGTGCAGAAAAGAATGATGCACAGGTTGGCGGCAACGAAGCCT \
# -b GGAGTCAAGTGCAGACGTAGTACGAAATGAGAGAGATGTCTTCCTCAATT \
# -b GGAGTCAAGTGCAGTAGTATATTCGGTTGTTTGCGGTAGAATAGATTCAA \
# -b ATTGTTATATTGCCCTAAAGGGGGGATTACCCGAGATCGGAAGAGCGGTTC \
# -b CGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTC \
# -b CGCATTTAGATGCTACTACCGTACTATCAAGAGGATTAGCTGCAAAAGGTN \
# -b CCGAGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGC \
# -b TGATATTTGCGAGTCGACGAATCTATTCCTATCAGGATTATTTTTTAGNNN \
#3 -b CCATATTCTCCTTGCTTGCATCCGAGATCGGAAGAGCGGTTCAGCAGGAAT \
# -b ATCTGTCTCTTCCGAGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCG \
# -b TGCCCGAGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTN \
# -b CGTCAGACAGGCTTGACGAACACCAGCTTTCTGGTTCTCGTTCCGNNNNNN \
# -b GAAAGGTGTCTATAACTTCTCCACCAGGACCTACCCCCCACCCTAGAGTNN  \
# -g GGAGTCAAG \
# -O 5 -f fastq ~/p2ep/Fla4BxW85_3_299pt76.fna > Fla4BxW85_3_299pt76.cutadapt.fastq


echo "finished job"

#done

#mv ${file}.fastq.adapt.dup ${file}/

